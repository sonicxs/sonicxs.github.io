<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊñêÊ≥¢ÈÇ£Â•ëËÆ°ÁÆóÂô® Pro - ÂΩ©Ëâ≤Áâà</title>
    <style>
        :root {
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --primary-color: #2563eb;
            --success-color: #059669;
            --border-color: #e2e8f0;
            --input-bg: #ffffff;
            /* TP È¢úËâ≤Âùó (‰∫ÆËâ≤Ê®°Âºè) */
            --tp1-bg: #ecfdf5; --tp1-text: #065f46;
            --tp2-bg: #dcfce7; --tp2-text: #166534;
            --tp3-bg: #ccfbe3; --tp3-text: #064e3b;
        }

        [data-theme="dark"] {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --primary-color: #3b82f6;
            --border-color: #334155;
            --input-bg: #0f172a;
            /* TP È¢úËâ≤Âùó (ÊöóËâ≤Ê®°Âºè) */
            --tp1-bg: #064e3b; --tp1-text: #6ee7b7;
            --tp2-bg: #14532d; --tp2-text: #86efac;
            --tp3-bg: #064e3b; --tp3-text: #10b981;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            padding: 20px; margin: 0;
            transition: all 0.3s ease;
        }

        .container {
            width: 100%; max-width: 500px;
            background: var(--card-bg);
            padding: 24px; border-radius: 16px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        h2 { margin: 0; font-size: 1.25rem; color: var(--primary-color); }

        .theme-toggle {
            background: none; border: 1px solid var(--border-color);
            padding: 5px 10px; border-radius: 8px; cursor: pointer;
            color: var(--text-main); font-size: 0.8rem;
        }

        .input-group { margin-bottom: 12px; }
        label { display: block; font-size: 0.8rem; font-weight: 600; margin-bottom: 4px; color: var(--text-muted); }
        input[type="text"] {
            width: 100%; padding: 12px; background: var(--input-bg);
            border: 1px solid var(--border-color); border-radius: 8px;
            box-sizing: border-box; color: var(--text-main); font-size: 1rem;
        }

        .button-group { display: grid; grid-template-columns: 2fr 1fr; gap: 10px; margin-top: 15px; }
        button { padding: 12px; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; transition: 0.2s; }
        .btn-calc { background: var(--primary-color); color: white; }
        .btn-export { background: #64748b; color: white; }
        button:hover { opacity: 0.9; transform: translateY(-1px); }

        hr { border: 0; border-top: 1px solid var(--border-color); margin: 20px 0; }

        ul { list-style: none; padding: 0; margin: 0; }
        li {
            display: flex; justify-content: space-between; align-items: center;
            padding: 10px 12px; margin-bottom: 4px; border-radius: 6px;
            transition: background 0.2s;
        }

        .label-text { font-size: 0.85rem; font-weight: 500; }
        .value-text { font-family: 'Monaco', 'Consolas', monospace; font-weight: 700; }

        /* ÁâπÂÆöÈ¢úËâ≤ÂùóÊ†∑Âºè */
        .entry-row { color: var(--primary-color); border-left: 4px solid var(--primary-color); background: rgba(37, 99, 235, 0.05); }
        .tp1-row { background-color: var(--tp1-bg); color: var(--tp1-text); }
        .tp2-row { background-color: var(--tp2-bg); color: var(--tp2-text); }
        .tp3-row { background-color: var(--tp3-bg); color: var(--tp3-text); }
        .setup-row { background-color: #fffbeb; color: #92400e; font-weight: bold; }
        [data-theme="dark"] .setup-row { background-color: #451a03; color: #fbbf24; }
    </style>
</head>
<body data-theme="light">
    <div class="container">
        <div class="header">
            <h2>ÊñêÊ≥¢ÈÇ£Â•ëËÆ°ÁÆóÂô®</h2>
            <button class="theme-toggle" onclick="toggleTheme()">üåì Ê®°ÂºèÂàáÊç¢</button>
        </div>
        
        <div class="input-group">
            <label>ÊúÄ‰Ωé/È´ò‰ª∑ (Start Price)</label>
            <input type="text" id="startPrice" value="25.0" />
        </div>
        <div class="input-group">
            <label>‰ø°Âè∑Êî∂Áõò‰ª∑ (End Price)</label>
            <input type="text" id="endPrice" value="25.5" />
        </div>

        <div class="button-group">
            <button class="btn-calc" onclick="onCalculate()">Á´ãÂç≥ËÆ°ÁÆó</button>
            <button class="btn-export" onclick="exportData()">ÂØºÂá∫ÊñáÊú¨</button>
        </div>

        <hr />

        <ul id="resultsList">
            <li><span class="label-text">0.0 Base</span><span class="value-text" id="f1">-</span></li>
            <li class="entry-row"><span class="label-text">0.236 Major Entry</span><span class="value-text" id="f11">-</span></li>
            <li class="entry-row"><span class="label-text">0.382 Minor Entry</span><span class="value-text" id="f12">-</span></li>
            <li><span class="label-text">0.618 Mid</span><span class="value-text" id="f13">-</span></li>
            <li><span class="label-text">0.786 Pullback</span><span class="value-text" id="f14">-</span></li>
            <li><span class="label-text">0.880 Pullback</span><span class="value-text" id="f15">-</span></li>
            <li class="setup-row"><span class="label-text">1.0 Setup</span><span class="value-text" id="f2">-</span></li>
            <li class="tp1-row"><span class="label-text">1.618 TP1</span><span class="value-text" id="f3">-</span></li>
            <li class="tp1-row"><span class="label-text">1.786 TP1 Ext</span><span class="value-text" id="f31">-</span></li>
            <li class="tp1-row"><span class="label-text">1.880 TP1 Ext</span><span class="value-text" id="f32">-</span></li>
            <li class="tp2-row"><span class="label-text">2.618 TP2</span><span class="value-text" id="f4">-</span></li>
            <li class="tp2-row"><span class="label-text">2.786 TP2 Ext</span><span class="value-text" id="f41">-</span></li>
            <li class="tp2-row"><span class="label-text">2.880 TP2 Ext</span><span class="value-text" id="f42">-</span></li>
            <li class="tp3-row"><span class="label-text">4.236 TP3</span><span class="value-text" id="f5">-</span></li>
            <li class="tp3-row"><span class="label-text">4.786 TP3 Ext</span><span class="value-text" id="f51">-</span></li>
            <li class="tp3-row"><span class="label-text">4.880 TP3 Ext</span><span class="value-text" id="f52">-</span></li>
        </ul>
    </div>

    <script>
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            body.setAttribute('data-theme', currentTheme === 'light' ? 'dark' : 'light');
        }

        function onCalculate() {
            const stp = parseFloat(document.getElementById("startPrice").value);
            const enp = parseFloat(document.getElementById("endPrice").value);
            
            if (isNaN(stp) || isNaN(enp)) return alert("ËØ∑ËæìÂÖ•Êï∞Â≠ó");
            if (stp === enp) return alert("‰ª∑Ê†º‰∏çËÉΩÁõ∏Á≠â");

            const diff = enp - stp;
            const levels = {
                "f1": 0, "f11": 0.236, "f12": 0.382, "f13": 0.618, "f14": 0.786, "f15": 0.880,
                "f2": 1.0, "f3": 1.618, "f31": 1.786, "f32": 1.880, "f4": 2.618, "f41": 2.786,
                "f42": 2.880, "f5": 4.236, "f51": 4.786, "f52": 4.880
            };

            for (let id in levels) {
                document.getElementById(id).innerText = (stp + diff * levels[id]).toFixed(3);
            }
        }

        function exportData() {
            const stp = document.getElementById("startPrice").value;
            const enp = document.getElementById("endPrice").value;
            let content = `ÊñêÊ≥¢ÈÇ£Â•ëËÆ°ÁÆóÁªìÊûú\nÂü∫ÂáÜ‰ª∑Ê†º: ${stp} -> ${enp}\n------------------\n`;
            
            const rows = document.querySelectorAll("#resultsList li");
            rows.forEach(row => {
                const label = row.querySelector(".label-text").innerText;
                const value = row.querySelector(".value-text").innerText;
                content += `${label}: ${value}\n`;
            });

            const blob = new Blob([content], { type: "text/plain" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = `Fib_Results_${new Date().getTime()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>